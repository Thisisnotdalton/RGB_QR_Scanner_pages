(()=>{var e,t,r,n,a,o,i={374:(e,t,r)=>{"use strict";r.r(t),r.d(t,{assembleRGBFilters:()=>i});var n=r(221);const a="\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform vec2 u_resolution;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n   // convert the rectangle from pixels to 0.0 to 1.0\n   vec2 zeroToOne = a_position / u_resolution;\n\n   // convert from 0->1 to 0->2\n   vec2 zeroToTwo = zeroToOne * 2.0;\n\n   // convert from 0->2 to -1->+1 (clipspace)\n   vec2 clipSpace = zeroToTwo - 1.0;\n\n   gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n\n   // pass the texCoord to the fragment shader\n   // The GPU will interpolate this value between points.\n   v_texCoord = a_texCoord;\n}\n";function o(e,t="r"){let r=document.getElementById(e);r||(r=document.createElement("canvas"),r.id=e);const o=r.getContext("webgl");if(null!==o){var i=(0,n.createShader)(o,o.VERTEX_SHADER,a),c=(0,n.createShader)(o,o.FRAGMENT_SHADER,function(e="r",t=.5){return`\nprecision mediump float;\n\n// our texture\nuniform sampler2D u_image;\n\n// the texCoords passed in from the vertex shader.\nvarying vec2 v_texCoord;\n\nvoid main() {\n  float channel = texture2D(u_image, v_texCoord).${e};\n  float high = channel > ${t}? 1.0: 0.0;\n  vec3 color = vec3(0);\n  color.${e} = high;\n  gl_FragColor = vec4(color, 1);\n}\n`}(t)),l=(0,n.createProgram)(o,i,c),d=document.createElement("canvas");d.id=`colorFilter_${t}`;var u=d.getContext("2d");return{input_canvas:r,output_canvas:d,filter:function(e){r.width=e.width,r.height=e.height,(0,n.render)(e,o,l),u.clearRect(0,0,r.width,r.height),d.width=e.width,d.height=e.height,u.drawImage(r,0,0)}}}alert("Unable to initialize WebGL. Your browser or machine may not support it.")}function i(){let e={red:o("redFilter","r"),green:o("greenFilter","g"),blue:o("blueFilter","b")},t={filter:function(t){for(let[r,n]of Object.entries(e))n.filter(t)},output_canvas:{},input_canvas:{}};for(let[r,n]of Object.entries(e))t.output_canvas[r]=n.output_canvas,t.input_canvas[r]=n.input_canvas;return t}},100:(e,t,r)=>{"use strict";r.a(e,(async(e,n)=>{try{r.r(t);var a=r(779),o=r(553),i=r(374),c=e([a]);function l(){console.log("Assembling RGB filters");let e=(0,i.assembleRGBFilters)();for(let[t,r]of Object.entries(e.output_canvas))document.body.appendChild(r);console.log("Acquiring video stream input"),(0,o.StreamToImage)().then((t=>{let r=document.getElementById("scan");t.image.onload=()=>{e.filter(t.image)},r.onclick=function(){for(let[t,r]of Object.entries(e.output_canvas))(0,a.scanImage)(r,`result_${t}`)}}))}a=(c.then?(await c)():c)[0],l(),n()}catch(d){n(d)}}))},779:(e,t,r)=>{"use strict";r.a(e,(async(e,n)=>{try{r.r(t),r.d(t,{scanImage:()=>o});var a=r(137);function o(e,t="result"){let r=document.getElementById(t);r||(r=document.createElement("div"),r.id=t),(0,a.S)(e).then((e=>{r.textContent=e?.text?e.text:"No data could be parsed from scanned image!"}))}await(0,a.G)(),n()}catch(i){n(i)}}),1)},553:(e,t,r)=>{"use strict";async function n(e="videoSelect",t=512,r=512,n=null){let a=null,o={},i=null;async function c(){await async function(){a||(a=document.getElementById(e),a||(a=document.createElement("select"),document.body.appendChild(a)),console.log(`Set up video selection: ${a}`))}(),await navigator.mediaDevices.enumerateDevices().then((function(e){for(var t=0;t!==e.length;++t){var r=e[t];if("videoinput"!==r.kind)continue;let n=null;r.deviceId in o?n=o[r.deviceId]:(n=document.createElement("option"),a.appendChild(n),o[r.deviceId]=n),n.value=r.deviceId,n.text=r.label||"Camera "+(Object.keys(o).length+1)}}))}return await c(),a.addEventListener("change",(function(e){(async function(){let e=null;Object.keys(o).length>0&&(e=a.options[a.selectedIndex||0].value),e?(await c(),i&&(await async function(e){e.getTracks().forEach((function(e){"live"===e.readyState&&e.stop()}))}(i),i=null),i=await async function(e=null){let n={audio:!1,video:{width:t,height:r}};return e&&(n.video.deviceId=e),await navigator.mediaDevices.getUserMedia(n)}(e),console.log(`Received stream: ${i}`),n&&n(i)):console.log("No device selected!")})().then((()=>{console.log(`Selected device: ${i}`)}))})),a.dispatchEvent(new Event("change")),{videoSelect:a}}async function a(e="video",t="image",r=512,a=512){let o=null,i=document.getElementById(e);i||(i=document.createElement("video")),console.log(`Using video element: ${i}`);let c=document.createElement("canvas");c.width=r,c.height=a;let l=c.getContext("2d"),d=document.getElementById(t);function u(){l.drawImage(i,0,0,r,a),d.src=c.toDataURL()}function s(e){(i.paused||i.ended)&&(i.load(),i.play()),o||(o=setInterval(u,e))}function f(){o&&(clearInterval(o),o=null)}return d||(d=new Image(r,a),d.id=t),console.log(`Using image element: ${d}`),await n("videoSelect",r,a,(function(e){f(),console.log(`Set up camera stream source: ${e}`),i.srcObject=e,s(100)})),{video:i,start:s,stop:f,image:d}}r.r(t),r.d(t,{StreamToImage:()=>a,VideoStreamSelector:()=>n})},221:(e,t,r)=>{"use strict";function n(e,t,r){var n=e.createShader(t);if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))return n;console.log(e.getShaderInfoLog(n)),e.deleteShader(n)}function a(e,t,r){var n=e.createProgram();if(e.attachShader(n,t),e.attachShader(n,r),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS))return n;console.log(e.getProgramInfoLog(n)),e.deleteProgram(n)}function o(e,t,r){var n=t.getAttribLocation(r,"a_position"),a=t.getAttribLocation(r,"a_texCoord"),o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),function(e,t,r,n,a){var o=0+n,i=0+a;e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,o,0,0,i,0,i,o,0,o,i]),e.STATIC_DRAW)}(t,0,0,e.width,e.height);var i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),t.STATIC_DRAW);var c=t.createTexture();t.bindTexture(t.TEXTURE_2D,c),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);var l=t.getUniformLocation(r,"u_resolution");t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.useProgram(r),t.enableVertexAttribArray(n),t.bindBuffer(t.ARRAY_BUFFER,o);var d=2,u=t.FLOAT,s=!1,f=0,m=0;t.vertexAttribPointer(n,d,u,s,f,m),t.enableVertexAttribArray(a),t.bindBuffer(t.ARRAY_BUFFER,i),d=2,u=t.FLOAT,s=!1,f=0,m=0,t.vertexAttribPointer(a,d,u,s,f,m),t.uniform2f(l,t.canvas.width,t.canvas.height);var v=t.TRIANGLES;m=0,t.drawArrays(v,m,6)}r.r(t),r.d(t,{createProgram:()=>a,createShader:()=>n,render:()=>o})},137:(e,t,r)=>{"use strict";let n;async function a(){return n||(n=async function(){const e=await r.e(283).then(r.bind(r,283)).then((e=>e.cv));await e.ready;const t=await async function(e){const t=await r.e(283).then(r.bind(r,283));return e.FS_createDataFile("/","detect.prototxt",t.detect_prototxt,!0,!1,!1),e.FS_createDataFile("/","detect.caffemodel",t.detect_caffemodel,!0,!1,!1),e.FS_createDataFile("/","sr.prototxt",t.sr_prototxt,!0,!1,!1),e.FS_createDataFile("/","sr.caffemodel",t.sr_caffemodel,!0,!1,!1),new e.wechat_qrcode_WeChatQRCode("detect.prototxt","detect.caffemodel","sr.prototxt","sr.caffemodel")}(e);return{cv:e,qrcode_detector:t}}()),n}async function o(){await a()}async function i(e,t={}){const{cv:r,qrcode_detector:n}=await a(),o=r.imread(e,r.IMREAD_GRAYSCALE),i=new r.MatVector,c=n.detectAndDecode(o,i),l=i.get(0),d=l?{x:l.floatAt(0),y:l.floatAt(1),width:l.floatAt(4)-l.floatAt(0),height:l.floatAt(5)-l.floatAt(1)}:void 0;let u;if(d&&t.includeRectCanvas){u=document.createElement("canvas");const e=o.roi(new r.Rect(d.x,d.y,d.width,d.height));r.imshow(u,e),e.delete()}return o.delete(),{text:c.get(0),rect:d,rectCanvas:u}}r.d(t,{G:()=>o,S:()=>i})}},c={};function l(e){var t=c[e];if(void 0!==t)return t.exports;var r=c[e]={exports:{}};return i[e](r,r.exports,l),r.exports}l.m=i,e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},l.a=(a,o,i)=>{var c;i&&((c=[]).d=-1);var l,d,u,s=new Set,f=a.exports,m=new Promise(((e,t)=>{u=t,d=e}));m[t]=f,m[e]=e=>(c&&e(c),s.forEach(e),m.catch((e=>{}))),a.exports=m,o((a=>{var o;l=(a=>a.map((a=>{if(null!==a&&"object"==typeof a){if(a[e])return a;if(a.then){var o=[];o.d=0,a.then((e=>{i[t]=e,n(o)}),(e=>{i[r]=e,n(o)}));var i={};return i[e]=e=>e(o),i}}var c={};return c[e]=e=>{},c[t]=a,c})))(a);var i=()=>l.map((e=>{if(e[r])throw e[r];return e[t]})),d=new Promise((t=>{(o=()=>t(i)).r=0;var r=e=>e!==c&&!s.has(e)&&(s.add(e),e&&!e.d&&(o.r++,e.push(o)));l.map((t=>t[e](r)))}));return o.r?d:i()}),(e=>(e?u(m[r]=e):d(f),n(c)))),c&&c.d<0&&(c.d=0)},l.d=(e,t)=>{for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((t,r)=>(l.f[r](e,t),t)),[])),l.u=e=>"./js/"+e+".app.js",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a={},o="rgb_qr_scanner:",l.l=(e,t,r,n)=>{if(a[e])a[e].push(t);else{var i,c;if(void 0!==r)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var s=d[u];if(s.getAttribute("src")==e||s.getAttribute("data-webpack")==o+r){i=s;break}}i||(c=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,l.nc&&i.setAttribute("nonce",l.nc),i.setAttribute("data-webpack",o+r),i.src=e),a[e]=[t];var f=(t,r)=>{i.onerror=i.onload=null,clearTimeout(m);var n=a[e];if(delete a[e],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach((e=>e(r))),t)return t(r)},m=setTimeout(f.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=f.bind(null,i.onerror),i.onload=f.bind(null,i.onload),c&&document.head.appendChild(i)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;l.g.importScripts&&(e=l.g.location+"");var t=l.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=e+"../"})(),(()=>{var e={524:0};l.f.j=(t,r)=>{var n=l.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var a=new Promise(((r,a)=>n=e[t]=[r,a]));r.push(n[2]=a);var o=l.p+l.u(t),i=new Error;l.l(o,(r=>{if(l.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;i.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",i.name="ChunkLoadError",i.type=a,i.request=o,n[1](i)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,a,[o,i,c]=r,d=0;if(o.some((t=>0!==e[t]))){for(n in i)l.o(i,n)&&(l.m[n]=i[n]);c&&c(l)}for(t&&t(r);d<o.length;d++)a=o[d],l.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkrgb_qr_scanner=self.webpackChunkrgb_qr_scanner||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),l(100),l(221),l(374),l(779),l(553)})();